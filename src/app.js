let productItem = [{
    id: 1,
    productName: "fry pan",
    price: "85.99",
    size: "8",
    color1: {
        color: "biscuit",
        image: "./assets/products/8inch_fry_biscuit.png",
        glb: "./assets/3d/8inch_fry_biscuit.glb"
    },
    color2: {
        color: "periwinkle",
        image: "./assets/products/8inch_fry_periwinkle.png",
        glb: "./assets/3d/8inch_fry_periwinkle.glb"
    },
    color3: {
        color: "forest",
        image: "./assets/products/8inch_fry_forest.png",
        glb: "./assets/3d/8inch_fry_forest.glb"
    },
    description: "Introducing our 8-inch fry pan, your go-to tool for versatile cooking adventures. Perfectly sized for cooking smaller portions, this pan is ideal for frying eggs, sautéing vegetables, searing meats, and crafting gourmet omelets with ease. With its durable hard-anodized body and healthy ceramic nonstick coating, you can indulge in guilt-free cooking while enjoying effortless cleanup. Elevate your culinary creations with precision and ease using our 8-inch fry pan, the perfect companion for any kitchen endeavor.",
    gtlf: "./assets/3d/8inch_fry_biscuit.glb"
},
{
    id: 2,
    productName: "fry pan",
    price: "99.99",
    size: "10",
    color1: {
        color: "forest",
        image: "./assets/products/10inch_fry_forest.png"
    },
    color2: {
        color: "mauve",
        image: "./assets/products/10inch_fry_mauve.png"
    },
    color3: {
        color: "twilight",
        image: "./assets/products/10inch_fry_twilight.png"
    },
    description: "Introducing our 10-inch fry pan, a kitchen essential designed to handle larger culinary creations with ease. From searing steaks to sautéing vegetables and crafting hearty stir-fries, this versatile pan is perfectly sized for cooking family-sized meals. Featuring a durable hard-anodized body and a healthy ceramic nonstick coating, this pan ensures both durability and guilt-free cooking, while the balanced base guarantees optimal oil distribution for consistent results. Elevate your cooking experience with our 10-inch fry pan, the perfect companion for any chef's kitchen repertoire.",
    gtlf: "./assets/3d/10inch_fry.glb"
},
{
    id: 3,
    productName: "fry pan",
    price: "129.99",
    size: "12",
    color1: {
        color: "mauve",
        image: "./assets/products/12inch_fry_mauve.png"
    },
    color2: {
        color: "grape",
        image: "./assets/products/12inch_fry_grape.png"
    },
    color3: {
        color: "periwinkle",
        image: "./assets/products/12inch_fry_periwinkle.png"
    },
    gtlf: "./assets/3d/12inch_fry.glb",
    description: "Introducing our 12-inch fry pan, the ultimate culinary workhorse for your kitchen adventures. With its spacious cooking surface, this pan is perfect for searing, frying, and sautéing larger quantities of ingredients with ease. Crafted with a durable hard-anodized body and featuring a healthy ceramic nonstick coating, it promises both resilience and guilt-free cooking, while the balanced base ensures optimal oil distribution for consistent results. Elevate your cooking prowess with our 12-inch fry pan, your go-to tool for creating delicious meals to share with family and friends."
},
{
    id: 4,
    productName: "sauce pan",
    price: "77.99",
    size: "6",
    color1: {
        color: "twilight",
        image: "./assets/products/6inch_sauce_twilight.png"
    },
    color2: {
        color: "forest",
        image: "./assets/products/6inch_sauce_forest.png"
    },
    color3: {
        color: "grape",
        image: "./assets/products/6inch_sauce_grape.png"
    },
    gtlf: "./assets/3d/6inch_sauce.glb",
    description: "Introducing our 6-inch saucepan with lid, a versatile kitchen essential designed for precise cooking tasks. Perfectly sized for heating sauces, simmering soups, and cooking smaller portions of grains or pasta, this saucepan is your go-to tool for culinary precision. Crafted with a durable hard-anodized body and featuring a healthy ceramic nonstick coating, it ensures both durability and guilt-free cooking, while the matching lid locks in flavors and moisture for delicious results every time. Elevate your cooking experience with our 6-inch saucepan, the perfect companion for creating culinary masterpieces with ease."
},
{
    id: 5,
    productName: "sauce pan",
    price: "92.99",
    size: "7",
    color1: {
        color: "grape",
        image: "./assets/products/7inch_sauce_grape.png"
    },
    color2: {
        color: "mauve",
        image: "./assets/products/7inch_sauce_mauve.png"
    },
    color3: {
        color: "biscuit",
        image: "./assets/products/7inch_sauce_biscuit.png"
    },
    gtlf: "./assets/3d/7inch_sauc.glb",
    description: "Introducing our 7-inch saucepan with lid, the versatile medium-sized addition to your kitchen lineup. Perfectly balancing capacity and compactness, this saucepan is ideal for heating sauces, simmering soups, or cooking moderate portions of grains and pasta. Crafted with a durable hard-anodized body and featuring a healthy ceramic nonstick coating, it ensures both resilience and guilt-free cooking, while the matching lid seals in flavors and moisture for delicious results every time. Elevate your culinary endeavors with our 7-inch saucepan, the perfect tool for achieving precise and flavorful dishes effortlessly."
},
{
    id: 6,
    productName: "sauce pan",
    price: "107.99",
    size: "8",
    color1: {
        color: "periwinkle",
        image: "./assets/products/8inch_sauce_periwinkle.png"
    },
    color2: {
        color: "biscuit",
        image: "./assets/products/8inch_sauce_biscuit.png"
    },
    color3: {
        color: "twilight",
        image: "./assets/products/8inch_sauce_twilight.png"
    },
    gtlf: "./assets/3d/8inch_sauce.glb",
    description: "Introducing our 8-inch saucepan with lid, the spacious solution for your culinary creations. With ample capacity, this saucepan is perfect for simmering sauces, cooking larger batches of soups, or boiling grains and pasta with ease. Crafted with a durable hard-anodized body and featuring a healthy ceramic nonstick coating, it ensures both durability and guilt-free cooking, while the matching lid seals in flavors and moisture for delicious results every time. Elevate your cooking experience with our 8-inch saucepan, the perfect companion for achieving flavorful dishes with ease and precision."
},
{
    id: 7,
    productName: "sauté pan",
    price: "102.99",
    size: "10.5",
    color1: {
        color: "biscuit",
        image: "./assets/products/10inch_saute_biscuit.png"
    },
    color2: {
        color: "periwinkle",
        image: "./assets/products/10inch_saute_periwinkle.png"
    },
    color3: {
        color: "grape",
        image: "./assets/products/10inch_saute_grape.png"
    },
    gtlf: "./assets/3d/10inch_saute.glb",
    description: "Introducing our 10.5-inch sauté pan with lid, a versatile essential for your culinary adventures. Perfectly balancing size and functionality, this pan is ideal for sautéing vegetables, searing meats, or simmering sauces with ease. Crafted with a durable hard-anodized body and featuring a healthy ceramic nonstick coating, it ensures both resilience and guilt-free cooking, while the matching lid seals in flavors and moisture for delicious results every time. Elevate your cooking experience with our 10.5-inch sauté pan, the perfect companion for achieving flavorful dishes with precision and ease."
},
{
    id: 8,
    productName: "sauté pan",
    price: "122.99",
    size: "12.5",
    color1: {
        color: "mauve",
        image: "./assets/products/12inch_saute_mauve.png"
    },
    color2: {
        color: "forest",
        image: "./assets/products/12inch_saute_forest.png"
    },
    color3: {
        color: "grape",
        image: "./assets/products/12inch_saute_grape.png"
    },
    gtlf: "./assets/3d/12inch_saute.glb",
    description: "Introducing our 12.5-inch sauté pan with lid, the ultimate kitchen companion for your culinary aspirations. With its expansive size and versatile design, this pan is perfect for searing, sautéing, and simmering large batches of ingredients with ease. Crafted with a durable hard-anodized body and featuring a healthy ceramic nonstick coating, it ensures both durability and guilt-free cooking, while the matching lid locks in flavors and moisture for delicious results every time. Elevate your cooking prowess with our 12.5-inch sauté pan, the ideal tool for creating impressive dishes to share with family and friends."
}];

$(document).ready(function() {
    updateActiveColor(productItem);
	showProductGallery(productItem);
    showProductPages(productItem);
	showCartTable();

    $('.color-choose input').on('click', function() {
        var color = $(this).attr('data-image');
        $('.active').removeClass('active');
        $('.left-column img[data-image = ' + color + ']').addClass('active');
        $(this).addClass('active');
        $('#colorShow').text(color);
    });

    $("#checkOut").click(function(){
        $("#myToast").toast("show");
    });
});

function updateActiveColor(product) {
    var color; 
    for (var i =0; i < product.length; i++) {
        currentProduct = product[i];
        var allImageSections = document.getElementById('product' + currentProduct.id);
        if (allImageSections != null) {
            var images = allImageSections.getElementsByClassName("hi");
            for (var j = 0; j < images.length; j++) {
                var current = allImageSections.getElementsByClassName("active").item(0);
                if (current == images.item(j)) {
                    var activeColor = current.getAttribute('data-image');
                    color = activeColor;
                }
            }
        }
    }
    return color
}

function updateActiveImage(product) {
    var image; 
    for (var i =0; i < product.length; i++) {
        currentProduct = product[i];
        var allImageSections = document.getElementById('product' + currentProduct.id);
        if (allImageSections != null) {
            var images = allImageSections.getElementsByClassName("hi");
            for (var j = 0; j < images.length; j++) {
                var current = allImageSections.getElementsByClassName("active").item(0);
                if (current == images.item(j)) {
                    var activeImage = current.getAttribute('src');
                    image = activeImage;
                }
            }
        }
    }
    return image
}

function addToCart(element) {
	var productParent = $(element).closest('div.product-item');

    var productName = $(productParent).find('.name').text();
    var size = $(productParent).find('.sizes').text();
	var price = $(productParent).find('.price span').text();
	var quantity = $(productParent).find('.product-quantity').val();
    var colorActive = updateActiveColor(productItem);
    var image = updateActiveImage(productItem);

    var cartIndex = -1;
    // If javascript id session is not empty
	if (sessionStorage.getItem('shopping-id')) {
		cartIndex = JSON.parse(sessionStorage.getItem('shopping-id'));
	}
	cartIndex = cartIndex + 1;
    var idJSON = JSON.stringify(cartIndex);
    sessionStorage.setItem('shopping-id', idJSON);
 
	var cartItem = {
        id: cartIndex,
		productName: productName,
        size: size,
		price: price,
		quantity: quantity,
        color: colorActive,
        image: image
	};
	var cartItemJSON = JSON.stringify(cartItem);

	var cartArray = new Array();
	// If javascript shopping cart session is not empty
	if (sessionStorage.getItem('shopping-cart')) {
		cartArray = JSON.parse(sessionStorage.getItem('shopping-cart'));
	}
	cartArray.push(cartItemJSON);

	var cartJSON = JSON.stringify(cartArray);
	sessionStorage.setItem('shopping-cart', cartJSON);

	showCartTable();
    $("#myToast").toast("show");
}

function emptyCart() {
	if (sessionStorage.getItem('shopping-cart')) {
		// Clear JavaScript sessionStorage by index
		sessionStorage.removeItem('shopping-cart');
        sessionStorage.removeItem('shopping-id');
		showCartTable();
	}
}


function removeCartItem(index) {
	if (sessionStorage.getItem('shopping-cart')) {
		var shoppingCart = JSON.parse(sessionStorage.getItem('shopping-cart'));

        var newArray = new Array();
        for (var i =0; i < shoppingCart.length; i++) {
            newArray.push(JSON.parse(shoppingCart[i]));
        }

        realindex = newArray.findIndex((obj) => obj.id === index);
        delete shoppingCart[realindex];
        var deleted = shoppingCart.filter((item) => item != null )
        sessionStorage.setItem('shopping-cart', JSON.stringify(deleted));
		showCartTable();
	}
}

function showCartTable() {
	var cartRowHTML = "";
	var itemCount = 0;
	var grandTotal = 0;
    var itemCount = 0;

	var price = 0;
	var quantity = 0;
	var subTotal = 0;

	if (sessionStorage.getItem('shopping-cart') && sessionStorage.getItem('shopping-cart')!='[]') {
		var shoppingCart = JSON.parse(sessionStorage.getItem('shopping-cart'));
		/* itemCount = shoppingCart.length; */

		//Iterate javascript shopping cart array
		shoppingCart.forEach(function(item) {
			var cartItem = JSON.parse(item);
			price = parseFloat(cartItem.price);
			quantity = parseInt(cartItem.quantity);
			subTotal = price * quantity

			cartRowHTML += "<tr>" +
                "<td class='align-middle first'>" +
                    "<div class='d-flex align-items-center'>" +
                        "<img src='" + cartItem.image + "'class='img-fluid rounded-3' style='width: 120px' alt='Product'>" +
                    "</div>" +
                "</td>"+
				"<td class='align-middle'>" + 
                    "<div class='flex-column'>" +
                        "<p class='mb-2'>" + cartItem.productName + "</p>" +
                        "<p class='mb-0'>"+ cartItem.size + "</p>" +
                    "</div>" +
                "</td>" +
                "<td class='align-middle'>" +
                    '<div class="colors_div_2">'+
                        '<span class="dot" style="background-color:var(--'+ cartItem.color +'); margin-right:5px;"></span>' +
                        '<span>' + cartItem.color +  '</span>' +
                    '</div>'+
                "</td>" +
				"<td class='align-middle'>$" + price.toFixed(2) + "</td>" +
				"<td class='align-middle'>" + quantity + "</td>" +
				"<td class='align-middle'>$" + subTotal.toFixed(2) + "</td>" +
                "<td class='align-middle'>"+
                    "<button class='btn_main' style='background-color:var(--yellow-1)' onClick='removeCartItem("+ cartItem.id+ ")'>" +
                        "<i class='bi bi-trash-fill'></i>" +
                    "</button>" +
                "</td>" +
				"</tr>";

			grandTotal += subTotal;
            itemCount += quantity;
		});
	}
    else {
        cartRowHTML += "<tr>" +
                "<td class='align-middle first'> </td>"+
				"<td class='align-middle'> </td>" +
                "<td class='align-middle'> </td>" +
				"<td class='align-middle'>  </td>" +
				"<td class='align-middle'>  </td>" +
				"<td class='align-middle'>  </td>" +
                "<td class='align-middle'>" +
                "</td>" +
				"</tr>";
        $('#cartTableBody').html(cartRowHTML);
    }
	$('#cartTableBody').html(cartRowHTML);
    $('#total_quantity').html(itemCount);
	$('#itemCount').text(itemCount);
	$('#totalAmount').text("$" + grandTotal.toFixed(2));
}


function showProductGallery(product) {
	//Iterate javascript shopping cart array
	var productHTML = "";
	product.forEach(function(item) {
		productHTML += 
                '<a href="product' + item.id + '.html" class="btn_product item" style="width: 25%; margin-left:35px; margin-right:35px;">'+
                '<div class="product-item">'+
                    '<img src="' + item.color1.image + '" class="img_product" alt="..."></img>'+
                    '<h5 class="name">' + item.productName + '</h5>'+
                    '<p class="price"> price: $' + item.price + '</p>'+
                    '<p class="sizes"> size: ' + item.size + 'in.</p>'+
                    '<div class="colors_div">'+
                    '<span class="colors"> colors available:</span>'+
                        '<span class="dot" style="background-color:var(--'+item.color1.color+')"></span>'+
                        '<span class="dot" style="background-color:var(--'+item.color2.color+')"></span>'+
                        '<span class="dot" style="background-color:var(--'+item.color3.color+')"></span>'+
                    '</div>'+
                '</div>'+
                '</a>';
                "<tr>";	
	});
	$('#product-item-container').html(productHTML);
}

function showProductPages(product) {
	//Iterate javascript shopping cart array
	product.forEach(function(item) {
        var productHTML = "";
		productHTML += 
                '<div class="product_container product-item">' + 
                /* Left Column / Image */
                '<div class="left-column" id="product'+item.id+'">' +
                    '<img data-image="'+ item.color1.color + '" class="hi active" src="'+ item.color1.image + '" alt="">' +
                    '<img data-image="'+ item.color2.color + '" class="hi" src="'+ item.color2.image + '" alt="" >' +
                    '<img data-image="'+ item.color3.color + '" class="hi" src="'+ item.color3.image + '" alt="" >' +
                '</div>' +
                /* Right Column */
                '<div class="right-column">' +
                    /* Product Description */
                    '<div>' +
                        '<h1 class="name display-4" style="font-family: coolvetica_reg;">'+ item.productName + '</h1>' +
                        '<div class="fs-5 mb-3">' +
                            '<p class="sizes lead" style="color: var(--blue-1)">'+ item.size + ' inches</p>' +
                            '<p class="price lead" style="color: var(--blue-1)";>$ <span>'+ item.price + '</span></p>' +
                        '</div>' +
                        '<p class="lead">'+ item.description + '</p>' +
                    '</div>' +
                    /* Product Configuration */
                    '<div class="product-configuration">' +
                    /* Product Color */
                    '<div class="product-color">' +
                        '<span>Color: ' + 
                            '<span id="colorShow">'+item.color1.color+'</span>' +
                        '</span>' +
                        '<div class="color-choose">' +
                        '<div>' +
                            '<input class="active" data-image="'+item.color1.color+'" type="radio" id="'+item.color1.color+'" name="color" value="'+item.color1.color+'" checked>' +
                            '<label for="'+item.color1.color+'"><span></span></label>' +
                        '</div>' +
                        '<div>' +
                            '<input class data-image="'+item.color2.color+'" type="radio" id="'+item.color2.color+'" name="color" value="'+item.color2.color+'">' +
                            '<label for="'+item.color2.color+'"><span></span></label>' +
                        '</div>' +
                        '<div>' +
                            '<input class data-image="'+item.color3.color+'" type="radio" id="'+item.color3.color+'" name="color" value="'+item.color3.color+'">' +
                            '<label for="'+item.color3.color+'"><span></span></label>' +
                        '</div>' +
                        '</div>' +
                    '</div>' +
                    '</div>' +
                    /* Product Purchase */
                    '<div class="d-flex">' +
                        '<input class="product-quantity form-control text-center me-3" type="text" name="quantity" value="1" size="2" style="background:wheat; border-radius: 30%;"/>' +
                        '<button class="btn_main flex-shrink-0" onClick="addToCart(this)">' +
                            '<i class="bi bi-bag me-1" style="-webkit-text-stroke: 1px;"></i>add to cart' +
                        '</button>' +
                    '</div>' +
                    '<div class="toast" style="position: absolute; margin-top: 10px; width: 30%; background-color: var(--yellow-1); border-color: wheat;" id="myToast">' +
                        '<div class="toast-header" style="background-color: var(--yellow-1); border-color: wheat; color:var(--blue-1)">' +
                            '<strong class="me-auto"><i class="bi bi-bag icon-blue me-3"></i> item was added to cart</strong>' +
                            '<button type="button" class="btn-close" data-bs-dismiss="toast"></button>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
            '</div>' +
            '<div style="height:30px;"></div>'+
            '<model-viewer src="'+item.gtlf+'" shadow-intensity="1"'+
            'camera-controls touch-action="pan-y">'+
            '</model-viewer>' +
            '<div style="height:30px;"></div>';
                $('#product' + item.id + '-page-container').html(productHTML);
	});
}
